<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>D-world/업무일지</title>
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <link rel="stylesheet" href="/css/basic.css">
        <link rel="stylesheet" href="/css/WorkLog.css">

        <script>
            $(document).ready(function() {
                $("#compl-yn").on("change", function(){
                    searchWorkLog();
                });
                $("#order1").on("change", function(){
                    searchWorkLog();
                });
                $("#order2").on("change", function(){
                    searchWorkLog();
                });
            });
            
            //검색 버튼
            function searchWorkLog(){
                var complYn = document.getElementById('compl-yn').value;
                var order1 = document.getElementById('order1').value;
                var order2 = document.getElementById('order2').value;
                var searchCustNm = document.getElementById('searchCustNm').value;
                var searchTitle = document.getElementById('searchTitle').value;

                window.location.href = "/dworld/worklog?complYn=" + encodeURIComponent(complYn) + "&order1=" + encodeURIComponent(order1) + "&order2=" + encodeURIComponent(order2) + "&custNm=" + encodeURIComponent(searchCustNm)+ "&title=" + encodeURIComponent(searchTitle);
            }
        </script>

    </head>
    <body>
        <div>
            <header th:include="header :: header"></header>
        </div>
        <div class="container border border-1 border-dark rounded px-3 py-2 mt-2">
            <div class="text-center">
                <H3>업무 일지 리스트</H3>
            </div>
            <!-- 검색 영역 -->
            <div class="d-flex justify-content-between py-2">
                <div class="d-flex align-items-center text-nowrap">
                    <button type="button" class="btn btn-outline-primary text-nowrap me-2" onclick="searchWorkLog()">검색</button>
                    <label for="searchCustNm">업체명</label>
                    <input type="text" class="form-control me-2" id="searchCustNm" name="searchCustNm" th:value="${SearchCustNm}" onkeyup="if(window.event.keyCode==13){searchWorkLog()}"/>
                    <label for="searchtitle">제목</label>
                    <input type="text" class="form-control" id="searchTitle" name="searchTitle" th:value="${SearchTitle}" onkeyup="if(window.event.keyCode==13){searchWorkLog()}"/>
                    
                </div>
                <div class="d-flex justify-content-end align-items-center">
                    <select class="form-select me-2" style="width: 150px;" id="compl-yn" name="compl-yn">   
                        <option value="N" th:if="${ResponseComplYn} == 'N'" selected>미완료</option>
                        <option value="N" th:unless="${ResponseComplYn} == 'N'">미완료</option>
                        <option value="Y" th:if="${ResponseComplYn} == 'Y'" selected>완료</option>
                        <option value="Y" th:unless="${ResponseComplYn} == 'Y'">완료</option>
                        <option value="A" th:if="${ResponseComplYn} == 'A'" selected>완료여부 전체</option>
                        <option value="A" th:unless="${ResponseComplYn} == 'A'">완료여부 전체</option>
                    </select>
                    <select class="form-select me-2" style="width: 150px;" id="order1" name="order2">
                        <option value="idx" th:if="${order1} == 'idx'" selected>작성 순번</option>
                        <option value="idx" th:unless="${order1} == 'idx'">작성 순번</option>
                        <option value="cust_nm" th:if="${order1} == 'cust_nm'" selected>업체명</option>
                        <option value="cust_nm" th:unless="${order1} == 'cust_nm'">업체명</option>
                        <option value="receipt_dt" th:if="${order1} == 'receipt_dt'" selected>접수일</option>
                        <option value="receipt_dt" th:unless="${order1} == 'receipt_dt'">접수일</option>
                        <option value="due_dt" th:if="${order1} == 'due_dt'" selected>완료 예정일</option>
                        <option value="due_dt" th:unless="${order1} == 'due_dt'">완료 예정일</option>
                    </select>
                    <select class="form-select me-2" style="width: 150px;" id="order2" name="order2">
                        <option value="desc" th:if="${order2} == 'desc'" selected>내림차순</option>
                        <option value="desc" th:unless="${order2} == 'desc'">내림차순</option>
                        <option value="asc" th:if="${order2} == 'asc'" selected>오름차순</option>
                        <option value="asc" th:unless="${order2} == 'asc'">오름차순</option>
                    </select>
                    <a href="/dworld/worklog/detail"><button type="button" class="btn btn-outline-primary">신규 작성</button></a>
                </div>
            </div>

            <!-- 테이블 영역 -->
            <table class="table table-hover table-hover">
                <colgroup>
                    <col width="5%" />
                    <col width="15%" />
                    <col width="35%" />
                    <col width="15%" />
                    <col width="15%" />
                    <col width="15%" />
                </colgroup>
                <thead>
                    <tr>
                        <th>Num</th>
                        <th>업체명</th>
                        <th>제목</th>
                        <th>접수일</th>
                        <th>완료예정일</th>
                        <th>완료일</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="list : ${WorkLogList.getList()}" class="text-wrap">
                        <td><a th:text='${list.rowNum}'></a></td>
                        <td><a th:text='${list.custNm}'></a></td>
                        <td><a th:text='${list.title}'></a></td>
                        <td><a type="" th:text='${list.receiptDt}'></a></td>
                        <td><a th:text='${list.dueDt}'></a></td>
                        <td><a th:text='${list.complDt}'></a></td>
                    </tr>
                    <tr th:unless="${#lists.size(WorkLogList.getList())} > 0">
                        <td colspan="6" class="text-center">내용이 없습니다.</td>
                    </tr>
                </tbody>
            </table>
            <ul class="pagination justify-content-center">
                <li class="page-item" th:classappend="${WorkLogList.getPrePage() == 0} ? 'disabled'">
                <a class="page-link" th:href="@{/dworld/worklog(pageNum=${WorkLogList.getPrePage()}, title=${SearchTitle}, custNm=${SearchCustNm}, complYn=${ResponseComplYn}, order1=${order1}, order2=${order2})}">Prev</a>
                </li>
                <li class="page-item" th:each="page: ${#numbers.sequence(WorkLogList.getNavigateFirstPage(), WorkLogList.getNavigateLastPage())}" th:classappend="${page == WorkLogList.getPageNum()} ? 'active'">
                <a class="page-link" th:text="${page}" th:href="@{/dworld/worklog(pageNum=${page}, title=${SearchTitle}, custNm=${SearchCustNm}, complYn=${ResponseComplYn}, order1=${order1}, order2=${order2})}"></a>
                </li>
                <li class="page-item" th:classappend="${WorkLogList.getNextPage() == 0} ? 'disabled'">
                <a class="page-link"  th:href="@{/dworld/worklog(pageNum=${WorkLogList.getNextPage()}, title=${SearchTitle}, custNm=${SearchCustNm}, complYn=${ResponseComplYn}, order1=${order1}, order2=${order2})}">Next</a>
                </li>
            </ul>
        </div>
    </body>
</html>